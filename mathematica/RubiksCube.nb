(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     70084,       1744]
NotebookOptionsPosition[     67061,       1679]
NotebookOutlinePosition[     67495,       1696]
CellTagsIndexPosition[     67452,       1693]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Solver", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.942393938558504*^9, 3.942393942873825*^9}, {
  3.942402306026436*^9, 3.9424023067828503`*^9}, {3.942529934907648*^9, 
  3.942529935462937*^9}, {3.9425382135090103`*^9, 3.9425382141361065`*^9}, {
  3.9425384876837482`*^9, 3.9425384883050137`*^9}, {3.942538528212036*^9, 
  3.9425385288833027`*^9}},ExpressionUUID->"4941fd4f-bbed-5042-ad54-\
25e76eadb325"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rubiksCubeSolve", "[", 
   RowBox[{"state_", "/;", 
    RowBox[{
     RowBox[{"Length", "[", "state", "]"}], "==", "6"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"faceIndices", "=", 
       RowBox[{"{", 
        RowBox[{
        "\"\<T\>\"", ",", "\"\<L\>\"", ",", "\"\<F\>\"", ",", "\"\<R\>\"", 
         ",", "\"\<B\>\"", ",", "\"\<D\>\""}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"colorToIndices", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Union", "@@", 
            RowBox[{"Values", "[", "state", "]"}]}], ",", 
           RowBox[{"Range", "[", "6", "]"}]}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"generators", "=", 
       RowBox[{"Cycles", "/@", 
        InterpretationBox[
         DynamicModuleBox[{Typeset`open = False}, 
          TemplateBox[{"List", "ListIcon", 
            GridBox[{{
               RowBox[{
                 TagBox["\"Head: \"", "IconizedLabel"], "\[InvisibleSpace]", 
                 TagBox["List", "IconizedItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "IconizedLabel"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"6", ",", "5", ",", "4"}], "}"}], 
                  "IconizedItem"]}]}, {
               RowBox[{
                 TagBox["\"Byte count: \"", "IconizedLabel"], 
                 "\[InvisibleSpace]", 
                 TagBox["14248", "IconizedItem"]}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
             "Column", 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
            Dynamic[Typeset`open]},
           "IconizedObject"]],
         {{{
            "T"[1], 
            "T"[3], 
            "T"[9], 
            "T"[7]}, {
            "T"[2], 
            "T"[6], 
            "T"[8], 
            "T"[4]}, {
            "L"[1], 
            "B"[1], 
            "R"[1], 
            "F"[1]}, {
            "L"[2], 
            "B"[2], 
            "R"[2], 
            "F"[2]}, {
            "L"[3], 
            "B"[3], 
            "R"[3], 
            "F"[3]}}, {{
            "L"[1], 
            "L"[3], 
            "L"[9], 
            "L"[7]}, {
            "L"[2], 
            "L"[6], 
            "L"[8], 
            "L"[4]}, {
            "T"[1], 
            "F"[1], 
            "D"[1], 
            "B"[9]}, {
            "T"[4], 
            "F"[4], 
            "D"[4], 
            "B"[6]}, {
            "T"[7], 
            "F"[7], 
            "D"[7], 
            "B"[3]}}, {{
            "F"[1], 
            "F"[3], 
            "F"[9], 
            "F"[7]}, {
            "F"[2], 
            "F"[6], 
            "F"[8], 
            "F"[4]}, {
            "T"[7], 
            "R"[1], 
            "D"[3], 
            "L"[9]}, {
            "T"[8], 
            "R"[4], 
            "D"[2], 
            "L"[6]}, {
            "T"[9], 
            "R"[7], 
            "D"[1], 
            "L"[3]}}, {{
            "R"[1], 
            "R"[3], 
            "R"[9], 
            "R"[7]}, {
            "R"[2], 
            "R"[6], 
            "R"[8], 
            "R"[4]}, {
            "T"[3], 
            "B"[7], 
            "D"[3], 
            "F"[3]}, {
            "T"[6], 
            "B"[4], 
            "D"[6], 
            "F"[6]}, {
            "T"[9], 
            "B"[1], 
            "D"[9], 
            "F"[9]}}, {{
            "B"[1], 
            "B"[3], 
            "B"[9], 
            "B"[7]}, {
            "B"[2], 
            "B"[6], 
            "B"[8], 
            "B"[4]}, {
            "T"[3], 
            "L"[1], 
            "D"[7], 
            "R"[9]}, {
            "T"[2], 
            "L"[4], 
            "D"[8], 
            "R"[6]}, {
            "T"[1], 
            "L"[7], 
            "D"[9], 
            "R"[3]}}, {{
            "D"[1], 
            "D"[3], 
            "D"[9], 
            "D"[7]}, {
            "D"[2], 
            "D"[6], 
            "D"[8], 
            "D"[4]}, {
            "L"[7], 
            "F"[7], 
            "R"[7], 
            "B"[7]}, {
            "L"[8], 
            "F"[8], 
            "R"[8], 
            "B"[8]}, {
            "L"[9], 
            "F"[9], 
            "R"[9], 
            "B"[9]}}},
         SelectWithContents->True,
         Selectable->False]}]}], ",", "\[IndentingNewLine]", 
      "rubiksCubeGroup", ",", "\[IndentingNewLine]", "faceToColor", ",", 
      "colorToFace", ",", "\[IndentingNewLine]", 
      RowBox[{"edgeBlocks", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<T\>\"", "[", "2", "]"}], ",", 
           RowBox[{"\"\<B\>\"", "[", "2", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<T\>\"", "[", "4", "]"}], ",", 
           RowBox[{"\"\<L\>\"", "[", "2", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<T\>\"", "[", "6", "]"}], ",", 
           RowBox[{"\"\<R\>\"", "[", "2", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<T\>\"", "[", "8", "]"}], ",", 
           RowBox[{"\"\<F\>\"", "[", "2", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<L\>\"", "[", "4", "]"}], ",", 
           RowBox[{"\"\<B\>\"", "[", "6", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<L\>\"", "[", "6", "]"}], ",", 
           RowBox[{"\"\<F\>\"", "[", "4", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<L\>\"", "[", "8", "]"}], ",", 
           RowBox[{"\"\<D\>\"", "[", "4", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<F\>\"", "[", "6", "]"}], ",", 
           RowBox[{"\"\<R\>\"", "[", "4", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<F\>\"", "[", "8", "]"}], ",", 
           RowBox[{"\"\<D\>\"", "[", "2", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<R\>\"", "[", "6", "]"}], ",", 
           RowBox[{"\"\<B\>\"", "[", "4", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<R\>\"", "[", "8", "]"}], ",", 
           RowBox[{"\"\<D\>\"", "[", "6", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<B\>\"", "[", "8", "]"}], ",", 
           RowBox[{"\"\<D\>\"", "[", "8", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"cornerBlocks", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<T\>\"", "[", "1", "]"}], ",", 
           RowBox[{"\"\<L\>\"", "[", "1", "]"}], ",", 
           RowBox[{"\"\<B\>\"", "[", "3", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<T\>\"", "[", "3", "]"}], ",", 
           RowBox[{"\"\<R\>\"", "[", "3", "]"}], ",", 
           RowBox[{"\"\<B\>\"", "[", "1", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<T\>\"", "[", "7", "]"}], ",", 
           RowBox[{"\"\<L\>\"", "[", "3", "]"}], ",", 
           RowBox[{"\"\<F\>\"", "[", "1", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<T\>\"", "[", "9", "]"}], ",", 
           RowBox[{"\"\<F\>\"", "[", "3", "]"}], ",", 
           RowBox[{"\"\<R\>\"", "[", "1", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<L\>\"", "[", "7", "]"}], ",", 
           RowBox[{"\"\<D\>\"", "[", "7", "]"}], ",", 
           RowBox[{"\"\<B\>\"", "[", "9", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<L\>\"", "[", "9", "]"}], ",", 
           RowBox[{"\"\<F\>\"", "[", "7", "]"}], ",", 
           RowBox[{"\"\<D\>\"", "[", "1", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<F\>\"", "[", "9", "]"}], ",", 
           RowBox[{"\"\<D\>\"", "[", "3", "]"}], ",", 
           RowBox[{"\"\<R\>\"", "[", "7", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<R\>\"", "[", "9", "]"}], ",", 
           RowBox[{"\"\<B\>\"", "[", "7", "]"}], ",", 
           RowBox[{"\"\<D\>\"", "[", "9", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
      "centerBlocks", ",", "\[IndentingNewLine]", "innerState", ",", 
      "\[IndentingNewLine]", "encodedBlocks", ",", "\[IndentingNewLine]", 
      "blockAssociation", ",", "\[IndentingNewLine]", "permutationRule", ",", 
      "targetPermutation"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"centerBlocks", "=", 
      RowBox[{"faceIndices", "/@", "5"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"faceToColor", " ", "=", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{"faceIndices", ",", 
          RowBox[{"Values", "[", 
           RowBox[{"state", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "5"}], "]"}], "]"}], "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"colorToFace", "=", 
      RowBox[{"Reverse", "/@", "faceToColor"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"innerState", "=", 
      RowBox[{
       RowBox[{"Association", "[", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"faceIndices", ",", 
            RowBox[{"Values", "[", "state", "]"}]}], "}"}]}], "]"}], "]"}], "/.",
        "colorToFace"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"encodedBlocks", "=", 
      RowBox[{"Map", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"block", ",", "\[IndentingNewLine]", 
          RowBox[{"block", "->", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"innerState", "[", 
                RowBox[{"Head", "[", "#", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "&"}], ",", 
             "block"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{"edgeBlocks", ",", "cornerBlocks"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "1", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"blockAssociation", "=", 
      RowBox[{"Association", "[", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Head", "/@", "#"}], "->", "#"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Catenate", "[", 
          RowBox[{"Permutations", "/@", 
           RowBox[{"Join", "[", 
            RowBox[{"edgeBlocks", ",", "cornerBlocks"}], "]"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"encodedBlocks", "=", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{"Rule", ",", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"encodedBlocks", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Replace", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"encodedBlocks", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"block_", ":>", 
             RowBox[{"Lookup", "[", 
              RowBox[{"blockAssociation", ",", 
               RowBox[{"Key", "[", "block", "]"}], ",", "Missing"}], "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", "1", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
         "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"encodedBlocks", ",", "Missing", ",", "Infinity"}], "]"}], 
       ",", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Invalid State!\>\"", "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"encodedBlocks", " ", "=", " ", 
      RowBox[{"Catenate", "[", 
       RowBox[{"Thread", "/@", "encodedBlocks"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"DuplicateFreeQ", "[", 
         RowBox[{"Values", "[", "encodedBlocks", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Error!\>\"", "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"permutationRule", "=", 
      RowBox[{"Replace", "[", "\[IndentingNewLine]", 
       RowBox[{"encodedBlocks", ",", "\[IndentingNewLine]", 
        RowBox[{"block_", ":>", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"First", "[", 
              RowBox[{"First", "[", 
               RowBox[{"Position", "[", 
                RowBox[{"faceIndices", ",", 
                 RowBox[{"Head", "[", "block", "]"}]}], "]"}], "]"}], "]"}], 
             "-", "1"}], ")"}], "*", "9"}], "+", 
          RowBox[{"block", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"targetPermutation", "=", 
      RowBox[{"FindPermutation", "[", 
       RowBox[{
        RowBox[{"Range", "[", "54", "]"}], ",", 
        RowBox[{
         RowBox[{"Range", "[", "54", "]"}], "/.", "permutationRule"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"generators", " ", "=", 
      RowBox[{"Replace", "[", "\[IndentingNewLine]", 
       RowBox[{"generators", ",", "\[IndentingNewLine]", 
        RowBox[{"block_", ":>", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"First", "[", 
              RowBox[{"First", "[", 
               RowBox[{"Position", "[", 
                RowBox[{"faceIndices", ",", 
                 RowBox[{"Head", "[", "block", "]"}]}], "]"}], "]"}], "]"}], 
             "-", "1"}], ")"}], "*", "9"}], "+", 
          RowBox[{"block", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "4", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"rubiksCubeGroup", "=", 
      RowBox[{"PermutationGroup", "[", "generators", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"GroupElementQ", "[", 
         RowBox[{"rubiksCubeGroup", ",", "targetPermutation"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Invalid State\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"GroupElementToWord", "[", 
       RowBox[{"rubiksCubeGroup", ",", "targetPermutation"}], "]"}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{"Rule", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Range", "[", "6", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"Range", "[", "6", "]"}]}]}], "]"}], ",", 
         RowBox[{"Join", "[", 
          RowBox[{"faceIndices", ",", 
           RowBox[{"-", "faceIndices"}]}], "]"}]}], "]"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.942394521756321*^9, 3.942394566893843*^9}, {
   3.942394743963156*^9, 3.942394784005766*^9}, 3.942394838634085*^9, {
   3.942394872323508*^9, 3.9423949096228085`*^9}, {3.942394968788571*^9, 
   3.9423949924418297`*^9}, {3.942395055866307*^9, 3.942395083871261*^9}, {
   3.942395374891157*^9, 3.942395402555889*^9}, {3.94239554851054*^9, 
   3.942395641640972*^9}, {3.942395689087395*^9, 3.94239570546716*^9}, {
   3.9423957395150585`*^9, 3.942395760058518*^9}, {3.942395813320598*^9, 
   3.942396249048506*^9}, {3.9423963200290203`*^9, 3.942396469750494*^9}, {
   3.942396521275879*^9, 3.942396772852436*^9}, 3.9423968062128887`*^9, {
   3.942396865404597*^9, 3.942396866993767*^9}, {3.942396897120695*^9, 
   3.942397033497401*^9}, {3.94239706814259*^9, 3.942397343002379*^9}, {
   3.942397373927273*^9, 3.942397453013672*^9}, {3.942397490413418*^9, 
   3.942397899694132*^9}, {3.942397930112032*^9, 3.942398008135788*^9}, {
   3.942398187883268*^9, 3.942398238266913*^9}, {3.942398583993412*^9, 
   3.9423985950098324`*^9}, {3.942398625586105*^9, 3.942398631404775*^9}, {
   3.942398683258386*^9, 3.9423987989313602`*^9}, {3.9423988505927486`*^9, 
   3.9423989592028313`*^9}, {3.9423991242123013`*^9, 3.942399140242916*^9}, {
   3.9423992655548553`*^9, 3.9423992666987286`*^9}, {3.94239930419734*^9, 
   3.942399322847283*^9}, {3.942399361975907*^9, 3.9423994102875633`*^9}, {
   3.9423994740019894`*^9, 3.942399477279207*^9}, {3.9423995110380745`*^9, 
   3.942399568378094*^9}, {3.942399634768062*^9, 3.942399671181425*^9}, {
   3.942399934264848*^9, 3.942399944608511*^9}, {3.9423999761070786`*^9, 
   3.942399985641725*^9}, {3.9424000577427654`*^9, 3.942400097517261*^9}, {
   3.942400129552089*^9, 3.942400241068712*^9}, {3.942400298062485*^9, 
   3.942400299572834*^9}, 3.942400368442499*^9, {3.942400401008611*^9, 
   3.942400448247125*^9}, {3.942400493926449*^9, 3.9424005092837067`*^9}, {
   3.94240056813583*^9, 3.942400708732773*^9}, {3.942400765425129*^9, 
   3.942400964236202*^9}, 3.942400998312683*^9, {3.942401046805342*^9, 
   3.94240112689752*^9}, {3.942401159661753*^9, 3.942401420197887*^9}, {
   3.942401453912697*^9, 3.942401536700262*^9}, {3.942401601720911*^9, 
   3.942401832402794*^9}, {3.9424018654649944`*^9, 3.942402034528473*^9}, {
   3.942402079480755*^9, 3.942402123094848*^9}, {3.942402425465313*^9, 
   3.94240242656802*^9}, {3.942537526577053*^9, 3.9425375303390007`*^9}, {
   3.9425376602741127`*^9, 3.9425376642670135`*^9}, 
   3.94253825903524*^9},ExpressionUUID->"c980fd87-b2c8-c340-bce0-\
c6f9150eebf1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Operators", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.942437162785621*^9, 3.942437166022293*^9}, {
  3.9424373653342953`*^9, 
  3.942437368266663*^9}},ExpressionUUID->"aabb534c-badf-dd4b-bf25-\
86155c12a660"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"operators", "=", 
  RowBox[{"Association", "[", 
   RowBox[{"MapThread", "[", 
    RowBox[{"Rule", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<T\>\"", ",", "\"\<L\>\"", ",", "\"\<F\>\"", ",", "\"\<R\>\"", 
         ",", "\"\<B\>\"", ",", "\"\<D\>\""}], "}"}], ",", 
       RowBox[{"Cycles", "/@", 
        InterpretationBox[
         DynamicModuleBox[{Typeset`open = False}, 
          TemplateBox[{"List", "ListIcon", 
            GridBox[{{
               RowBox[{
                 TagBox["\"Head: \"", "IconizedLabel"], "\[InvisibleSpace]", 
                 TagBox["List", "IconizedItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "IconizedLabel"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"6", ",", "5", ",", "4"}], "}"}], 
                  "IconizedItem"]}]}, {
               RowBox[{
                 TagBox["\"Byte count: \"", "IconizedLabel"], 
                 "\[InvisibleSpace]", 
                 TagBox["4648", "IconizedItem"]}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
             "Column", 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
            Dynamic[Typeset`open]},
           "IconizedObject"]],
         {{{1, 3, 9, 7}, {2, 6, 8, 4}, {10, 37, 28, 19}, {11, 38, 29, 20}, {
         12, 39, 30, 21}}, {{10, 12, 18, 16}, {11, 15, 17, 13}, {1, 19, 46, 
         45}, {4, 22, 49, 42}, {7, 25, 52, 39}}, {{19, 21, 27, 25}, {20, 24, 
         26, 22}, {7, 28, 48, 18}, {8, 31, 47, 15}, {9, 34, 46, 12}}, {{28, 
         30, 36, 34}, {29, 33, 35, 31}, {3, 43, 48, 21}, {6, 40, 51, 24}, {9, 
         37, 54, 27}}, {{37, 39, 45, 43}, {38, 42, 44, 40}, {3, 10, 52, 36}, {
         2, 13, 53, 33}, {1, 16, 54, 30}}, {{46, 48, 54, 52}, {47, 51, 53, 
         49}, {16, 25, 34, 43}, {17, 26, 35, 44}, {18, 27, 36, 45}}},
         SelectWithContents->True,
         Selectable->False]}]}], "}"}]}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9424371755954742`*^9, 3.9424372191345005`*^9}, 
   3.942437322510544*^9, {3.942473758094162*^9, 3.942473758996737*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"cc683411-e4ba-5641-ac66-f56293e20c17"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"T\"\>", "\[Rule]", 
    RowBox[{"Cycles", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "9", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "6", ",", "8", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "37", ",", "28", ",", "19"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11", ",", "38", ",", "29", ",", "20"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12", ",", "39", ",", "30", ",", "21"}], "}"}]}], "}"}], 
     "]"}]}], ",", 
   RowBox[{"\<\"L\"\>", "\[Rule]", 
    RowBox[{"Cycles", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "19", ",", "46", ",", "45"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "22", ",", "49", ",", "42"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"7", ",", "25", ",", "52", ",", "39"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "12", ",", "18", ",", "16"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11", ",", "15", ",", "17", ",", "13"}], "}"}]}], "}"}], 
     "]"}]}], ",", 
   RowBox[{"\<\"F\"\>", "\[Rule]", 
    RowBox[{"Cycles", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"7", ",", "28", ",", "48", ",", "18"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"8", ",", "31", ",", "47", ",", "15"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"9", ",", "34", ",", "46", ",", "12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"19", ",", "21", ",", "27", ",", "25"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20", ",", "24", ",", "26", ",", "22"}], "}"}]}], "}"}], 
     "]"}]}], ",", 
   RowBox[{"\<\"R\"\>", "\[Rule]", 
    RowBox[{"Cycles", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"3", ",", "43", ",", "48", ",", "21"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6", ",", "40", ",", "51", ",", "24"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"9", ",", "37", ",", "54", ",", "27"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28", ",", "30", ",", "36", ",", "34"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"29", ",", "33", ",", "35", ",", "31"}], "}"}]}], "}"}], 
     "]"}]}], ",", 
   RowBox[{"\<\"B\"\>", "\[Rule]", 
    RowBox[{"Cycles", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "16", ",", "54", ",", "30"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "13", ",", "53", ",", "33"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "10", ",", "52", ",", "36"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"37", ",", "39", ",", "45", ",", "43"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"38", ",", "42", ",", "44", ",", "40"}], "}"}]}], "}"}], 
     "]"}]}], ",", 
   RowBox[{"\<\"D\"\>", "\[Rule]", 
    RowBox[{"Cycles", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"16", ",", "25", ",", "34", ",", "43"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"17", ",", "26", ",", "35", ",", "44"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"18", ",", "27", ",", "36", ",", "45"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"46", ",", "48", ",", "54", ",", "52"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"47", ",", "51", ",", "53", ",", "49"}], "}"}]}], "}"}], 
     "]"}]}]}], "\[RightAssociation]"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{3.9424372138666744`*^9, 3.942437323683485*^9, 
  3.942437356880354*^9, 3.942441097722065*^9, 3.94244282982518*^9, 
  3.9424551494274597`*^9, 3.942464294588941*^9, 3.942472334659042*^9, 
  3.942473759414757*^9, 3.942474150894729*^9, 3.9424804008328743`*^9, 
  3.942481058404946*^9, 3.9425365030414085`*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"45238076-8744-574b-a9fc-efecf889117b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyOperator", "[", 
   RowBox[{"state_", ",", "operator_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"op", "=", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "operator", "]"}], "===", "Times"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"InversePermutation", "[", 
          RowBox[{"operators", "[", 
           RowBox[{"operator", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"operators", "[", "operator", "]"}]}], "\[IndentingNewLine]",
         "]"}]}], ",", "\[IndentingNewLine]", "flattenState"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"flattenState", "=", 
      RowBox[{"Catenate", "[", 
       RowBox[{"Values", "[", "state", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Association", "[", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Keys", "[", "state", "]"}], ",", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Permute", "[", 
             RowBox[{"flattenState", ",", "op"}], "]"}], ",", "9"}], "]"}]}], 
         "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.942437369942505*^9, 3.942437518592835*^9}, {
  3.942437644219345*^9, 3.942437667206953*^9}, {3.9424377244368343`*^9, 
  3.942437727404692*^9}, {3.942473765787834*^9, 3.9424737697327614`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"0eeaf6d0-c783-a349-ac76-5109d68b70a1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Visualization", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.942402315127136*^9, 3.942402316958406*^9}, 
   3.942450859023311*^9},ExpressionUUID->"0158bf06-b70d-a944-8d23-\
c662d4aa7b94"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"face", "[", 
    RowBox[{"center_", ",", 
     RowBox[{"angle_", ":", "0"}], ",", 
     RowBox[{"vec_", ":", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"len_", ":", "1"}], ",", 
     RowBox[{"color_", ":", "Red"}]}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"color", ",", "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"center", "+", 
           RowBox[{"#", ".", 
            RowBox[{"RotationMatrix", "[", 
             RowBox[{"angle", ",", "vec"}], "]"}]}]}], ")"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "len"}], "/", "2"}], ",", 
            RowBox[{
             RowBox[{"-", "len"}], "/", "2"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"len", "/", "2"}], ",", 
            RowBox[{
             RowBox[{"-", "len"}], "/", "2"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"len", "/", "2"}], ",", 
            RowBox[{"len", "/", "2"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "len"}], "/", "2"}], ",", 
            RowBox[{"len", "/", "2"}], ",", "0"}], "}"}]}], "}"}]}], "]"}], 
      "]"}]}], "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.942393944347639*^9, 3.942393946593073*^9}, {
   3.9423940812131214`*^9, 3.942394141281773*^9}, {3.942394349008633*^9, 
   3.942394481177477*^9}, {3.942434084764397*^9, 3.942434176350605*^9}, {
   3.942434242265276*^9, 3.9424342959906483`*^9}, {3.942435995425178*^9, 
   3.942436004118107*^9}, {3.942436309974069*^9, 3.9424363325710716`*^9}, 
   3.942481012281458*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"c8278766-08ed-2f43-8cbb-35b73accac87"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rubiksCube", "[", 
   RowBox[{"state_", ",", 
    RowBox[{"len_", ":", "1"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"refFacesCenters", "=", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Catenate", "[", 
          RowBox[{"Outer", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#1", ",", "#2", ",", "0"}], "}"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"Catenate", "[", 
          RowBox[{"Outer", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#2", ",", "0", ",", "#1"}], "}"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"Catenate", "[", 
          RowBox[{"Outer", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "#2", ",", "#1"}], "}"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"Catenate", "[", 
          RowBox[{"Outer", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#2", ",", "0", ",", "#1"}], "}"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Catenate", "[", 
          RowBox[{"Outer", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "#2", ",", "#1"}], "}"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Catenate", "[", 
          RowBox[{"Outer", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#1", ",", "#2", ",", "0"}], "}"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], "]"}], 
          "]"}]}], "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"faceIndices", "=", 
       RowBox[{"{", 
        RowBox[{
        "\"\<T\>\"", ",", "\"\<L\>\"", ",", "\"\<F\>\"", ",", "\"\<R\>\"", 
         ",", "\"\<B\>\"", ",", "\"\<D\>\""}], "}"}]}], ",", 
      "\[IndentingNewLine]", "faceCenterCoordinates", ",", 
      "\[IndentingNewLine]", "faceOrientations", ",", "\[IndentingNewLine]", 
      RowBox[{"faceOffsets", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"3", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "3"}], "/", "2"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"3", "/", "2"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"3", "/", "2"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], "/", "2"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{
            RowBox[{"-", "3"}], "/", "2"}]}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", "innerState"}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"innerState", "=", 
      RowBox[{"Association", "[", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{"faceIndices", ",", 
           RowBox[{"Values", "[", "state", "]"}]}], "}"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"faceOrientations", "=", 
      RowBox[{"Association", "@", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"faceIndices", ",", "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"0", "->", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Pi", "/", "2"}], "->", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Pi", "/", "2"}], "->", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Pi", "/", "2"}], "->", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Pi", "/", "2"}], "->", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"0", "->", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], 
            "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"faceCenterCoordinates", "=", 
      RowBox[{"Association", "@", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "->", 
           RowBox[{"Transpose", "[", 
            RowBox[{"Plus", "[", 
             RowBox[{"#2", ",", 
              RowBox[{"Transpose", "[", "#3", "]"}]}], "]"}], "]"}]}], "&"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
          "faceIndices", ",", "\[IndentingNewLine]", "faceOffsets", ",", 
           "\[IndentingNewLine]", "refFacesCenters"}], "\[IndentingNewLine]", 
          "}"}]}], "\[IndentingNewLine]", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{"faceInd", ",", "\[IndentingNewLine]", 
        RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"pos", ",", "ort", ",", "color"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"face", "[", 
             RowBox[{"pos", ",", 
              RowBox[{"ort", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"ort", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "len", ",", "color"}], 
             "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"faceCenterCoordinates", "[", "faceInd", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"faceOrientations", "[", "faceInd", "]"}], ",", "9"}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"innerState", "[", "faceInd", "]"}]}], 
           "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}], "/@", "faceIndices"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwlzjtIQnEYxmELSiPsgmMR2GQXqJDIosSGgqAhIuiCpmguIqRgEiF0KMWi
ILsgJw2CkC7okGSYhWV4IAkrCQehCzU4RSQhZJHQef8NH8/y8eMVqicHtYUc
DqeaPRiiPJRN+d7NmHLE3GcovcDaVCJ9g7wGNZ9mfUlayyDj7LLDEzvfDQ35
mgNIR8TE/ZvMFbSem79g1qgo2mQ9jJ4Vw6HYUymUq2zl8PfOK4DZWkEPbC7Q
9EGH8FkLJb2VOlgR8xshJXdOkY5eNwc9sjY7XH68X4HJLek26dUteqFPMByA
qbnxIPGUuYC5+vg1NA1EbiFtM6dgp5n5hqIYnSc7ViXzLtYEV22HEyOiJWhJ
9BNjQcsa3KA0zv+/YxeUhbluaBhr3YGSjxmig3HsQlNasQcbM+1eyGvxH0FV
9DJMunJxBOp9VXE4PdqRhNaf9QcYUM6+wj8vPPBJ
  "],
 CellLabel->"In[5]:=",ExpressionUUID->"11f7916e-5577-9d43-b1c7-ebc8e41e5d22"]
}, Closed]],

Cell[CellGroupData[{

Cell["Make Animation", "Section",
 CellChangeTimes->{{3.942437013431433*^9, 3.942437013761736*^9}, {
  3.9424392919546585`*^9, 3.942439292129425*^9}, {3.9424735732051086`*^9, 
  3.942473575076956*^9}},ExpressionUUID->"14fb991f-d039-2d48-ab2f-\
de6ad92a0dd8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"animateOperation", "[", 
   RowBox[{"state_", ",", "operator_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"angleRange", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "operator", "]"}], "===", "Times"}], ",", 
         RowBox[{"Pi", "/", "2"}], ",", 
         RowBox[{
          RowBox[{"-", "Pi"}], "/", "2"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"op", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "operator", "]"}], "===", "Times"}], ",", 
         RowBox[{"operator", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "operator"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"rotationVecs", "=", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<T\>\"", "->", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
         RowBox[{"\"\<L\>\"", "->", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ",", 
         RowBox[{"\"\<F\>\"", "->", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<R\>\"", "->", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
         RowBox[{"\"\<B\>\"", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], ",", 
         RowBox[{"\"\<D\>\"", "->", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}]}], "\[IndentingNewLine]", "|>"}]}], 
      ",", "\[IndentingNewLine]", "cube", ",", "\[IndentingNewLine]", 
      RowBox[{"rotationFaces", "=", 
       RowBox[{"<|", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<T\>\"", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<T\>\"", ",", 
              RowBox[{"Range", "[", "9", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<L\>\"", ",", 
              RowBox[{"Range", "[", "3", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<F\>\"", ",", 
              RowBox[{"Range", "[", "3", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<R\>\"", ",", 
              RowBox[{"Range", "[", "3", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<B\>\"", ",", 
              RowBox[{"Range", "[", "3", "]"}]}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<L\>\"", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<L\>\"", ",", 
              RowBox[{"Range", "[", "9", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<T\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "4", ",", "7"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<F\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "4", ",", "7"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<D\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "4", ",", "7"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<B\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "6", ",", "9"}], "}"}]}], "}"}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<F\>\"", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<F\>\"", ",", 
              RowBox[{"Range", "[", "9", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<T\>\"", ",", 
              RowBox[{"Range", "[", 
               RowBox[{"7", ",", "9"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<R\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "4", ",", "7"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<D\>\"", ",", 
              RowBox[{"Range", "[", "3", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<L\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "6", ",", "9"}], "}"}]}], "}"}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<R\>\"", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<R\>\"", ",", 
              RowBox[{"Range", "[", "9", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<T\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "6", ",", "9"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<B\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "4", ",", "7"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<D\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "6", ",", "9"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<F\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "6", ",", "9"}], "}"}]}], "}"}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<B\>\"", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<B\>\"", ",", 
              RowBox[{"Range", "[", "9", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<T\>\"", ",", 
              RowBox[{"Range", "[", "3", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<L\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "4", ",", "7"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<D\>\"", ",", 
              RowBox[{"Range", "[", 
               RowBox[{"7", ",", "9"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<R\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "6", ",", "9"}], "}"}]}], "}"}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<D\>\"", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<D\>\"", ",", 
              RowBox[{"Range", "[", "9", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<F\>\"", ",", 
              RowBox[{"Range", "[", 
               RowBox[{"7", ",", "9"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<R\>\"", ",", 
              RowBox[{"Range", "[", 
               RowBox[{"7", ",", "9"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<B\>\"", ",", 
              RowBox[{"Range", "[", 
               RowBox[{"7", ",", "9"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<L\>\"", ",", 
              RowBox[{"Range", "[", 
               RowBox[{"7", ",", "9"}], "]"}]}], "}"}]}], "}"}]}]}], 
        "\[IndentingNewLine]", "|>"}]}], ",", "\[IndentingNewLine]", 
      "animationReplaceRules"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cube", "=", 
      RowBox[{"Association", "@", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Keys", "[", "rotationVecs", "]"}], ",", 
           RowBox[{"rubiksCube", "[", "state", "]"}]}], "}"}]}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"animationReplaceRules", "=", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"angle", ",", "\[IndentingNewLine]", 
         RowBox[{"Catenate", "[", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"face", ",", "inds"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"cube", "[", "face", "]"}], "[", 
                RowBox[{"[", "inds", "]"}], "]"}], ",", 
               RowBox[{"p_Polygon", ":>", 
                RowBox[{"(", 
                 RowBox[{"p", "->", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"RotationTransform", "[", 
                    RowBox[{"angle", ",", 
                    RowBox[{"rotationVecs", "[", "op", "]"}]}], "]"}], "[", 
                    "p", "]"}], ")"}]}], ")"}]}], ",", 
               RowBox[{"{", "2", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
            "]"}], "@@@", 
           RowBox[{"rotationFaces", "[", "op", "]"}]}], "\[IndentingNewLine]",
           "]"}]}], "\[IndentingNewLine]", "]"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "angleRange", ",", 
         RowBox[{"angleRange", "/", "10"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Values", "[", "cube", "]"}], "/.", 
      "animationReplaceRules"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.942442971299022*^9, 3.9424431484981728`*^9}, {
   3.94244318936389*^9, 3.942443593152139*^9}, {3.942443656835548*^9, 
   3.942443723326175*^9}, {3.942443790986061*^9, 3.942443800998169*^9}, {
   3.942443965980324*^9, 3.9424440755683975`*^9}, 3.942446113087187*^9, {
   3.942446152461143*^9, 3.94244626290514*^9}, {3.942446367174944*^9, 
   3.942446538413223*^9}, {3.942446573588226*^9, 3.942446641302788*^9}, {
   3.942446685906128*^9, 3.942446752230551*^9}, {3.942446807947235*^9, 
   3.942447048535095*^9}, {3.942447159319608*^9, 3.9424471609664917`*^9}, {
   3.942447205582472*^9, 3.942447308059795*^9}, {3.942448324909447*^9, 
   3.942448326091604*^9}, {3.9424486718714027`*^9, 3.942448672530762*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"e5d6f419-8989-a74c-b260-4e217f2e59d3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generate Random State", "Section",
 CellChangeTimes->{{3.942473588364443*^9, 
  3.9424735945709286`*^9}},ExpressionUUID->"b422da43-abf9-0f42-b30d-\
d8f1207a8da3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"randomState", "[", 
   RowBox[{
    RowBox[{"seed_", ":", "0"}], ",", 
    RowBox[{"opt", ":", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<Color\>\"", "->", 
        RowBox[{"{", 
         RowBox[{
         "White", ",", "Blue", ",", "Yellow", ",", "Red", ",", "Orange", ",", 
          "Green"}], "}"}]}], "}"}], "]"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"targetState", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Rule", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"#2", ",", "9"}], "]"}]}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<T\>\"", ",", "\"\<L\>\"", ",", "\"\<F\>\"", ",", "\"\<R\>\"",
              ",", "\"\<B\>\"", ",", "\"\<D\>\""}], "}"}], ",", 
           RowBox[{"OptionValue", "[", "\"\<Color\>\"", "]"}]}], "}"}]}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"rubiksCubeGroup", "=", 
       RowBox[{"PermutationGroup", "[", 
        RowBox[{"Values", "[", "operators", "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", "element"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "seed", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"element", "=", 
      RowBox[{"First", "@", 
       RowBox[{"RandomPermutation", "[", 
        RowBox[{"rubiksCubeGroup", ",", "1"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Association", "@", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Keys", "[", "targetState", "]"}], ",", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Permute", "[", 
             RowBox[{
              RowBox[{"Catenate", "[", 
               RowBox[{"Values", "[", "targetState", "]"}], "]"}], ",", 
              "element"}], "]"}], ",", "9"}], "]"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9424736181203804`*^9, 3.94247373031567*^9}, {
  3.94247378069771*^9, 3.942474008344509*^9}, {3.942474061397774*^9, 
  3.942474130543581*^9}, {3.9424741723606243`*^9, 3.942474177500501*^9}, {
  3.94248037980793*^9, 3.942480396687113*^9}, {3.942481024695942*^9, 
  3.942481055005863*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"caa7285d-fd55-204b-b8da-6f84b3ae3c28"]
}, Closed]],

Cell[CellGroupData[{

Cell["Solve and Visualize", "Section",
 CellChangeTimes->{{3.9424736003219795`*^9, 
  3.942473613530727*^9}},ExpressionUUID->"289f5f7b-372b-9e4c-b7c1-\
cc56064973c7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"state", "=", 
  RowBox[{"randomState", "[", "0", "]"}]}]], "Input",
 CellChangeTimes->{{3.942474159088873*^9, 3.942474183022764*^9}, {
  3.9424742313032413`*^9, 3.9424742463355656`*^9}, {3.942476124648185*^9, 
  3.942476125415224*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"f618101d-6913-6d4d-9518-8a0f9b3bc535"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"T\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[<|"color" -> RGBColor[1, 1, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[0, 0, 1]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 0, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[0, 0, 1]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> GrayLevel[1]|>,
       "GrayLevelColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[0, 1, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 0.5, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 0.5, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> GrayLevel[1]|>,
       "GrayLevelColorSwatchTemplate"]}], "}"}]}], ",", 
   RowBox[{"\<\"L\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[<|"color" -> RGBColor[0, 1, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[0, 1, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[0, 0, 1]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[0, 1, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[0, 0, 1]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 0, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 1, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 0.5, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> GrayLevel[1]|>,
       "GrayLevelColorSwatchTemplate"]}], "}"}]}], ",", 
   RowBox[{"\<\"F\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[<|"color" -> GrayLevel[1]|>,
       "GrayLevelColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[0, 0, 1]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[0, 0, 1]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 1, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 1, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[0, 0, 1]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 0.5, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> GrayLevel[1]|>,
       "GrayLevelColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[0, 1, 0]|>,
       "RGBColorSwatchTemplate"]}], "}"}]}], ",", 
   RowBox[{"\<\"R\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[<|"color" -> RGBColor[1, 1, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 0.5, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> GrayLevel[1]|>,
       "GrayLevelColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> GrayLevel[1]|>,
       "GrayLevelColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 0, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 0, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 0.5, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> GrayLevel[1]|>,
       "GrayLevelColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 0.5, 0]|>,
       "RGBColorSwatchTemplate"]}], "}"}]}], ",", 
   RowBox[{"\<\"B\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[<|"color" -> RGBColor[1, 1, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 1, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[0, 0, 1]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 0.5, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 0.5, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 1, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[0, 1, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 0, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[0, 1, 0]|>,
       "RGBColorSwatchTemplate"]}], "}"}]}], ",", 
   RowBox[{"\<\"D\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[<|"color" -> RGBColor[1, 0, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 0, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[0, 0, 1]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> GrayLevel[1]|>,
       "GrayLevelColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[0, 1, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 1, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 0, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[0, 1, 0]|>,
       "RGBColorSwatchTemplate"], ",", 
      TemplateBox[<|"color" -> RGBColor[1, 0, 0]|>,
       "RGBColorSwatchTemplate"]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.942474162038877*^9, 3.9424741832338667`*^9}, {
   3.942474231687048*^9, 3.942474246523083*^9}, 3.9424761257723927`*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"0ec516d4-3951-514b-8ec1-096732b9e0b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"operations", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Minus", "/@", 
     RowBox[{"rubiksCubeSolve", "[", "state", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"operations", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.9424370221362553`*^9, 3.942437024663204*^9}, {
   3.942437116219389*^9, 3.942437123200672*^9}, 3.942438692627991*^9, {
   3.942439000978428*^9, 3.9424390157994976`*^9}, {3.9424742251644993`*^9, 
   3.942474228096308*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"a4918d8b-ef60-0346-9b05-7877ad8ecac3"],

Cell[BoxData["106"], "Output",
 CellChangeTimes->{{3.9424742283742733`*^9, 3.94247424761402*^9}},
 CellLabel->"Out[31]=",ExpressionUUID->"a38c0aa1-f4b5-6f4a-97fb-077f7f9a80b1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"solSequence", "=", 
   RowBox[{"FoldPairList", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DirectedEdge", "[", 
         RowBox[{"#1", ",", 
          RowBox[{"applyOperator", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], ",", "#2"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"applyOperator", "[", 
         RowBox[{"#1", ",", "#2"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
      "&"}], ",", "\[IndentingNewLine]", "state", ",", "\[IndentingNewLine]", 
     "operations"}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.942438704685013*^9, 3.942438799839561*^9}, 
   3.9424389288273506`*^9, {3.942438975606283*^9, 3.942438978747589*^9}, {
   3.942439018938867*^9, 3.942439022774534*^9}, {3.94244751400251*^9, 
   3.9424476343586216`*^9}, {3.942447736312893*^9, 3.94244775396344*^9}, {
   3.942447788450817*^9, 3.942447862080868*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"a18f58e4-2541-2640-85bf-660bc5b87b9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"transformAnimations", "=", 
   RowBox[{"Catenate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{"edge", ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"s1", "=", 
            RowBox[{"edge", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"s2", "=", 
            RowBox[{"edge", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"op", "=", 
            RowBox[{"edge", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rubiksCube", "[", "s1", "]"}], "}"}], ",", 
           RowBox[{"animateOperation", "[", 
            RowBox[{"s1", ",", "op"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"rubiksCube", "[", "s2", "]"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], "/@", 
     "solSequence"}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.942448123398329*^9, 3.942448217009651*^9}, {
  3.942448304647485*^9, 3.942448339098345*^9}, {3.942448976582248*^9, 
  3.94244898016304*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"83aa3cea-b2e5-e741-a5cb-0476589f8b7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"frameList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Partition", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"vp", ",", "\[IndentingNewLine]", 
            RowBox[{"Graphics3D", "[", 
             RowBox[{"#", ",", "\[IndentingNewLine]", 
              RowBox[{"Lighting", "->", "\"\<Neutral\>\""}], ",", 
              RowBox[{"Boxed", "->", "False"}], ",", 
              RowBox[{"Axes", "->", "False"}], ",", 
              RowBox[{"PlotRange", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ViewPoint", "->", "vp"}]}], "\[IndentingNewLine]", 
             "]"}]}], "\[IndentingNewLine]", "]"}], "/@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Left", ",", "Front", ",", "Top"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Right", ",", "Back", ",", "Bottom"}], "}"}]}], "}"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"UpTo", "[", "2", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{"ImageSize", "->", "1000"}]}], "\[IndentingNewLine]", "]"}], 
     "&"}], "/@", "transformAnimations"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9424554409760437`*^9, 3.942455453502615*^9}, {
   3.9424557446041565`*^9, 3.9424557464045067`*^9}, 3.942455837889204*^9},
 CellLabel->"In[35]:=",ExpressionUUID->"57863a9b-ec53-ed4a-9e3c-ca57f4f9f56e"],

Cell[BoxData[
 RowBox[{"Export", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{
      RowBox[{"ParentDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", "\"\<videos\>\"", 
      ",", "\"\<RubiksCube-Solution.mp4\>\""}], "]"}], "<>"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"FrameListVideo", "[", "\[IndentingNewLine]", 
    RowBox[{"frameList", "\[IndentingNewLine]", ",", 
     RowBox[{"FrameRate", "->", "20"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.942448514900618*^9, 3.942448549330253*^9}, {
  3.942448619183024*^9, 3.942448624728348*^9}, {3.94244865713418*^9, 
  3.942448729053777*^9}, {3.942448762994789*^9, 3.942448772005327*^9}, {
  3.942448943831842*^9, 3.942448944325268*^9}, {3.942448983268908*^9, 
  3.942448984068052*^9}, {3.942449492663038*^9, 3.942449496640068*^9}, {
  3.942449541233961*^9, 3.9424495879862576`*^9}, {3.942450107851042*^9, 
  3.942450164311744*^9}, {3.942450239255495*^9, 3.9424503672390823`*^9}, {
  3.942450401960773*^9, 3.942450404941641*^9}, {3.9424504629976788`*^9, 
  3.942450465432548*^9}, {3.94245049638926*^9, 3.9424505024177494`*^9}, {
  3.9424554400029736`*^9, 3.942455474510582*^9}, {3.942464330257971*^9, 
  3.942464333955055*^9}, {3.9424720983434563`*^9, 3.942472131006107*^9}, {
  3.942481700109434*^9, 
  3.9424817066185684`*^9}},ExpressionUUID->"cc8a4e37-ce68-1b48-b5c8-\
fec94a4f771a"]
}, Open  ]]
},
WindowSize->{1141.2, 568.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1. Inherited,
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"2a9d4fe2-4294-5648-b2f2-b2e0898971eb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 429, 7, 67, "Section",ExpressionUUID->"4941fd4f-bbed-5042-ad54-25e76eadb325",
 InitializationCell->True],
Cell[1012, 31, 19727, 503, 1847, "Input",ExpressionUUID->"c980fd87-b2c8-c340-bce0-c6f9150eebf1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[20776, 539, 232, 5, 53, "Section",ExpressionUUID->"aabb534c-badf-dd4b-bf25-86155c12a660",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[21033, 548, 2372, 49, 51, "Input",ExpressionUUID->"cc683411-e4ba-5641-ac66-f56293e20c17",
 InitializationCell->True],
Cell[23408, 599, 3960, 99, 128, "Output",ExpressionUUID->"45238076-8744-574b-a9fc-efecf889117b",
 InitializationCell->True]
}, Open  ]],
Cell[27383, 701, 1803, 43, 254, "Input",ExpressionUUID->"0eeaf6d0-c783-a349-ac76-5109d68b70a1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[29223, 749, 208, 4, 53, "Section",ExpressionUUID->"0158bf06-b70d-a944-8d23-c662d4aa7b94",
 InitializationCell->True],
Cell[29434, 755, 2051, 52, 120, "Input",ExpressionUUID->"c8278766-08ed-2f43-8cbb-35b73accac87",
 InitializationCell->True],
Cell[31488, 809, 9171, 227, 976, "Input",ExpressionUUID->"11f7916e-5577-9d43-b1c7-ebc8e41e5d22",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[40696, 1041, 258, 4, 53, "Section",ExpressionUUID->"14fb991f-d039-2d48-ab2f-de6ad92a0dd8"],
Cell[40957, 1047, 10125, 245, 558, "Input",ExpressionUUID->"e5d6f419-8989-a74c-b260-4e217f2e59d3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[51119, 1297, 168, 3, 53, "Section",ExpressionUUID->"b422da43-abf9-0f42-b30d-d8f1207a8da3"],
Cell[51290, 1302, 2627, 65, 197, "Input",ExpressionUUID->"caa7285d-fd55-204b-b8da-6f84b3ae3c28",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[53954, 1372, 166, 3, 53, "Section",ExpressionUUID->"289f5f7b-372b-9e4c-b7c1-cc56064973c7"],
Cell[CellGroupData[{
Cell[54145, 1379, 338, 6, 28, "Input",ExpressionUUID->"f618101d-6913-6d4d-9518-8a0f9b3bc535"],
Cell[54486, 1387, 5781, 132, 52, "Output",ExpressionUUID->"0ec516d4-3951-514b-8ec1-096732b9e0b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60304, 1524, 583, 12, 48, "Input",ExpressionUUID->"a4918d8b-ef60-0346-9b05-7877ad8ecac3"],
Cell[60890, 1538, 176, 2, 32, "Output",ExpressionUUID->"a38c0aa1-f4b5-6f4a-97fb-077f7f9a80b1"]
}, Open  ]],
Cell[61081, 1543, 1086, 22, 162, "Input",ExpressionUUID->"a18f58e4-2541-2640-85bf-660bc5b87b9f"],
Cell[62170, 1567, 1416, 34, 143, "Input",ExpressionUUID->"83aa3cea-b2e5-e741-a5cb-0476589f8b7f"],
Cell[63589, 1603, 1971, 44, 219, "Input",ExpressionUUID->"57863a9b-ec53-ed4a-9e3c-ca57f4f9f56e"],
Cell[65563, 1649, 1482, 27, 143, "Input",ExpressionUUID->"cc8a4e37-ce68-1b48-b5c8-fec94a4f771a"]
}, Open  ]]
}
]
*)

